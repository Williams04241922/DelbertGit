<!DOCTYPE html>
<script src="../checkCountry.js"></script>
<html>
<script src="../../header2.js"></script>
<body>
<div class="body">
    <script src="menu2.js"></script>
    <style>
        /* Keep main navigation menu red - Override all blue colors */
        .nav-main > li > a,
        .nav-main > li > a:hover,
        .nav-main > li > a:focus,
        .nav-main > li > a:active,
        .nav-main > li.active > a,
        .nav-main > li.active > a:hover,
        .nav-main > li.active > a:focus,
        .nav-pills > li > a,
        .nav-pills > li > a:hover,
        .nav-pills > li > a:focus,
        .nav-pills > li.active > a,
        .nav-pills > li.active > a:hover,
        .nav-pills > li.active > a:focus {
            color: #C8102E !important;
            background-color: transparent !important;
        }

        /* Dropdown menu items */
        .nav-main .dropdown-menu > li > a:hover,
        .nav-main .dropdown-menu > li > a:focus {
            background-color: #C8102E !important;
            color: white !important;
        }
    </style>
    <script>
        // Mark Showroom menu item as active
        document.addEventListener('DOMContentLoaded', function() {
            var menuItems = document.querySelectorAll('.nav-main > li > a');
            menuItems.forEach(function(item) {
                if (item.getAttribute('href') && item.getAttribute('href').indexOf('showroom.html') !== -1) {
                    item.parentElement.classList.add('active');
                }
            });
        });
    </script>
    <div role="main" class="main">
        <div class="container">
            <h1 class="page-header" style="margin-top: 20px; margin-bottom: 30px; color: #C8102E; font-weight: bold;">
                Interactive Showroom
            </h1>
            <p class="lead" style="margin-bottom: 30px;">
                Explore our furniture collection in beautifully designed room settings. Click on any product to view details.
            </p>

            <!-- Room Tabs -->
            <ul class="nav nav-tabs" id="roomTabs" style="margin-bottom: 20px;">
                <li class="active">
                    <a href="#livingRoom" data-toggle="tab" data-category="Sofas & Chair">
                        Living Room
                    </a>
                </li>
                <li>
                    <a href="#bedroom" data-toggle="tab" data-category="Beds & Mattresses">
                        Bedroom
                    </a>
                </li>
                <li>
                    <a href="#dining" data-toggle="tab" data-category="Tables & Desks">
                        Dining
                    </a>
                </li>
                <li>
                    <a href="#homeOffice" data-toggle="tab" data-category="Study">
                        Home Office
                    </a>
                </li>
                <li>
                    <a href="#bathroom" data-toggle="tab" data-category="Bathroom">
                        Bathroom
                    </a>
                </li>
            </ul>

            <!-- Loading Indicator -->
            <div id="loadingIndicator" style="text-align: center; padding: 50px; display: none;">
                <i class="icon icon-spinner icon-spin" style="font-size: 48px; color: #C8102E;"></i>
                <p style="margin-top: 15px; font-size: 16px;">Loading products...</p>
            </div>

            <!-- Error Message -->
            <div id="errorMessage" class="alert alert-danger" style="display: none;">
                <strong>Error!</strong> <span id="errorText"></span>
            </div>

            <!-- Tab Content -->
            <div class="tab-content">
                <!-- Living Room -->
                <div class="tab-pane active" id="livingRoom">
                    <div class="showroom-container" style="position: relative; width: 100%; min-height: 500px; background-size: cover; background-position: center; background-image: url('../../img/slides/slide-bg.jpg'); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.1);"></div>
                        <div id="livingRoomProducts" class="products-grid" style="position: relative; padding: 30px; min-height: 500px;"></div>
                    </div>
                </div>

                <!-- Bedroom -->
                <div class="tab-pane" id="bedroom">
                    <div class="showroom-container" style="position: relative; width: 100%; min-height: 500px; background-size: cover; background-position: center; background-image: url('../../img/slides/slide-light-1.jpg'); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.1);"></div>
                        <div id="bedroomProducts" class="products-grid" style="position: relative; padding: 30px; min-height: 500px;"></div>
                    </div>
                </div>

                <!-- Dining -->
                <div class="tab-pane" id="dining">
                    <div class="showroom-container" style="position: relative; width: 100%; min-height: 500px; background-size: cover; background-position: center; background-image: url('../../img/slides/slide-1.jpg'); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.1);"></div>
                        <div id="diningProducts" class="products-grid" style="position: relative; padding: 30px; min-height: 500px;"></div>
                    </div>
                </div>

                <!-- Home Office -->
                <div class="tab-pane" id="homeOffice">
                    <div class="showroom-container" style="position: relative; width: 100%; min-height: 500px; background-size: cover; background-position: center; background-image: url('../../img/slides/slide-2.jpg'); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.1);"></div>
                        <div id="homeOfficeProducts" class="products-grid" style="position: relative; padding: 30px; min-height: 500px;"></div>
                    </div>
                </div>

                <!-- Bathroom -->
                <div class="tab-pane" id="bathroom">
                    <div class="showroom-container" style="position: relative; width: 100%; min-height: 500px; background-size: cover; background-position: center; background-image: url('../../img/slides/slide-bg-light.jpg'); border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.1);"></div>
                        <div id="bathroomProducts" class="products-grid" style="position: relative; padding: 30px; min-height: 500px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../../footer.js"></script>
</div>

<style>
    /* Tab Styles - Keep them red - Override all blue colors */
    #roomTabs > li > a,
    #roomTabs > li > a:hover,
    #roomTabs > li > a:focus,
    #roomTabs > li > a:active,
    #roomTabs > li.active > a,
    #roomTabs > li.active > a:hover,
    #roomTabs > li.active > a:focus,
    .nav-tabs > li > a,
    .nav-tabs > li > a:hover,
    .nav-tabs > li > a:focus,
    .nav-tabs > li.active > a,
    .nav-tabs > li.active > a:hover,
    .nav-tabs > li.active > a:focus {
        color: #C8102E !important;
        border-color: #C8102E !important;
        background-color: #fff !important;
    }

    #roomTabs > li.active > a,
    #roomTabs > li.active > a:hover,
    #roomTabs > li.active > a:focus,
    .nav-tabs > li.active > a,
    .nav-tabs > li.active > a:hover,
    .nav-tabs > li.active > a:focus {
        border-bottom-color: transparent !important;
    }

    /* Product Card Styles */
    .product-hotspot {
        display: inline-block;
        margin: 15px;
        width: 280px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.15);
        transition: all 0.3s ease;
        cursor: pointer;
        vertical-align: top;
        overflow: hidden;
    }

    .product-hotspot:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(200,16,46,0.3);
    }

    .product-image-container {
        position: relative;
        width: 100%;
        height: 200px;
        background: #f8f8f8;
        overflow: hidden;
    }

    .product-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .product-hotspot:hover .product-image-container img {
        transform: scale(1.1);
    }

    .product-info {
        padding: 15px;
    }

    .product-code {
        font-size: 11px;
        color: #999;
        text-transform: uppercase;
        margin-bottom: 5px;
        font-weight: 600;
    }

    .product-name {
        font-size: 16px;
        font-weight: bold;
        color: #333;
        margin-bottom: 8px;
        min-height: 40px;
        line-height: 1.3;
    }

    .product-price {
        font-size: 20px;
        font-weight: bold;
        color: #C8102E;
        margin-bottom: 10px;
    }

    .product-category-badge {
        display: inline-block;
        padding: 4px 10px;
        background: #C8102E;
        color: white;
        font-size: 10px;
        border-radius: 3px;
        text-transform: uppercase;
        font-weight: 600;
        margin-top: 5px;
    }

    .no-products-message {
        text-align: center;
        padding: 80px 20px;
        color: white;
        background: rgba(0,0,0,0.3);
        border-radius: 8px;
        margin: 20px;
    }

    .no-products-message h3 {
        color: white;
        margin-bottom: 10px;
    }

    .no-products-message p {
        color: rgba(255,255,255,0.9);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .product-hotspot {
            width: calc(50% - 30px);
            margin: 10px;
        }
    }

    @media (max-width: 480px) {
        .product-hotspot {
            width: calc(100% - 20px);
            margin: 10px;
        }
    }
</style>

<script>
    // Get country ID from localStorage
    var countryId = localStorage.getItem("countryId") || "25"; // Default to Singapore (ID: 25)
    var countryPrefix = localStorage.getItem("urlPrefix") || "SG";

    // Room to container mapping
    var roomContainers = {
        'Sofas & Chair': 'livingRoomProducts',
        'Beds & Mattresses': 'bedroomProducts',
        'Tables & Desks': 'diningProducts',
        'Study': 'homeOfficeProducts',
        'Bathroom': 'bathroomProducts'
    };

    // Cache to store loaded products
    var productsCache = {};

    // Load products for a specific category
    function loadProducts(category, containerId) {
        // Check cache first
        if (productsCache[category]) {
            displayProducts(productsCache[category], containerId, category);
            return;
        }

        // Show loading indicator
        $('#loadingIndicator').show();
        $('#errorMessage').hide();

        $.ajax({
            url: '/api/getFurnitureByCat',
            type: 'GET',
            data: {
                countryId: countryId,
                cat: category
            },
            success: function(response) {
                $('#loadingIndicator').hide();
                productsCache[category] = response;
                displayProducts(response, containerId, category);
            },
            error: function(xhr, status, error) {
                $('#loadingIndicator').hide();
                $('#errorText').text('Failed to load products. Please try again later.');
                $('#errorMessage').show();
                console.error('Error loading products:', error);
            }
        });
    }

    // Display products in the container
    function displayProducts(products, containerId, category) {
        var container = $('#' + containerId);
        container.empty();

        if (!products || products.length === 0) {
            container.html(
                '<div class="no-products-message">' +
                '<h3><i class="icon icon-info-circle"></i> No Products Available</h3>' +
                '<p>Currently, there are no products in this category. Please check back later.</p>' +
                '</div>'
            );
            return;
        }

        // Display up to 6 products per room
        var productsToShow = products.slice(0, 6);

        productsToShow.forEach(function(product) {
            var productCard = $('<div class="product-hotspot"></div>');

            // Product image
            var imageUrl = product.imageUrl || '/img/products/' + product.sku + '.jpg';
            var imageContainer = $('<div class="product-image-container"></div>');
            var img = $('<img>').attr('src', imageUrl).attr('alt', product.name);

            // Handle image load error
            img.on('error', function() {
                $(this).attr('src', '/img/slides/slide-concept.png');
            });

            imageContainer.append(img);
            productCard.append(imageContainer);

            // Product info
            var infoDiv = $('<div class="product-info"></div>');
            infoDiv.append('<div class="product-code">SKU: ' + product.sku + '</div>');
            infoDiv.append('<div class="product-name">' + product.name + '</div>');
            infoDiv.append('<div class="product-price">$' + parseFloat(product.price).toFixed(2) + '</div>');
            infoDiv.append('<span class="product-category-badge">' + category + '</span>');

            productCard.append(infoDiv);

            // Click handler to navigate to product details
            productCard.on('click', function() {
                window.location.href = '/B/' + countryPrefix + '/furnitureProductDetails.html?sku=' + product.sku;
            });

            container.append(productCard);
        });
    }

    // Tab change handler
    $('#roomTabs a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
        var category = $(e.target).data('category');
        var containerId = roomContainers[category];

        if (containerId) {
            loadProducts(category, containerId);
        }
    });

    // Load initial room (Living Room) on page load
    $(document).ready(function() {
        loadProducts('Sofas & Chair', 'livingRoomProducts');
    });
</script>

<!-- Vendor JS -->
<script src="/vendor/modernizr.js"></script>
<script src="/vendor/bootstrap/js/bootstrap.js"></script>

</body>
</html>
